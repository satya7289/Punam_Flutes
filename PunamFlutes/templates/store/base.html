{% load staticfiles %}
<!doctype html>
<html lang="en">

<!-- Mirrored from yevgenysim.github.io/shopper/index-classic.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 30 Jun 2020 09:59:34 GMT -->
<!-- Added by HTTrack -->
<meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Favicons -->
  <link rel="icon" href="{% static 'assets/img/favicons/favicon.ico' %}">

  <!-- Libs CSS -->
  <link rel="stylesheet" href="{% static 'assets/libs/%40fancyapps/fancybox/dist/jquery.fancybox.min.css' %}">
  <link rel="stylesheet" href="{% static 'assets/libs/%40fortawesome/fontawesome-free/css/all.min.css'%}">
  <link rel="stylesheet" href="{% static 'assets/libs/flickity/dist/flickity.min.css'%}">
  <link rel="stylesheet" href="{% static 'assets/libs/highlightjs/styles/vs2015.css'%}">
  <link rel="stylesheet" href="{% static 'assets/libs/simplebar/dist/simplebar.min.css'%}">
  <link rel="stylesheet" href="{% static 'assets/libs/flickity-fade/flickity-fade.css'%}">
  <link rel="stylesheet" href="{% static 'assets/fonts/feather/feather.css'%}">

  <!-- Theme CSS -->
  <link rel="stylesheet" href="{% static 'assets/css/theme.min.css'%}">
  <!-- fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Gabriela&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="{% static 'homepage/css/main.css'%}">

  <style>
    @media screen and (min-width: 1500px) {
      .container{max-width: 85%;font-size: 1.5rem;}
    }
  </style>
</head>

<body>

  <!-- Shopping Cart -->
  <div class="modal fixed-right fade" id="modalShoppingCart" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog modal-dialog-vertical" role="document">

      <input type="hidden" id="modal__cart" value="{{ is_cart_detail}}">
      <!-- Full cart (add `.d-none` to disable it) -->
      <div class="modal-content" id="full__cart">

        <!-- Close -->
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <i class="fe fe-x" aria-hidden="true"></i>
        </button>

        <!-- Header-->
        <div class="modal-header line-height-fixed font-size-lg">
          <strong class="mx-auto">Your Cart ({{ cart_length }})</strong>
        </div>

        <!-- List group -->
        <ul class="list-group list-group-lg list-group-flush">
          
          {% for product in cart_detail.products %}
          
          <li class="list-group-item">
            <div class="row align-items-center">
              <div class="col-4">

                <!-- Image -->
                <a href="!#">
                  <img class="img-fluid" src="{{ product.product.images.all.0.image.url }}" alt="...">
                </a>

              </div>
              <div class="col-8">

                <!-- Title -->
                <p class="font-size-sm font-weight-bold mb-6">
                  <a class="text-body" href="!#">{{ product.product.title }}</a> <br>
                  <span class="text-muted" id="modal__product__price__{{forloop.counter}}" data-total="{{ product.price }}">{{ currency_symbol }} {{ product.price }}</span>
                </p>

                <!--Footer -->
                <div class="d-flex align-items-center">

                  <!-- Select -->
                  <select class="custom-select custom-select-xxs w-auto" name="quantity__modal" id="{{ forloop.counter }}" data-price="{{ product.price }}">
                    {% if product.product.inventory and product.product.inventory.type == "limited" and product.inventory.available == 0 %}
                        <div class="font-weight-bold text-center" style="background-color: brown; padding: 0.5rem; margin: .5rem;">
                          <span> Out of stock</span>
                        </div>
                    {% elif product.product.inventory and product.product.inventory.type == "limited" and product.product.inventory.available < 5 %}

                        {% for _ in ''|center:product.product.inventory.available %}
                          {% if forloop.counter is product.quantity %}
                            <option value="{{ forloop.counter }}" selected>{{ forloop.counter }}</option>
                          {% else %}
                            <option value="{{ forloop.counter }}">{{ forloop.counter }}</option>
                          {% endif %}
                        {% endfor %}
                      

                      {% else %}
                    
                        {% for i in cart_detail.range %}
                          {% if i is product.quantity %}
                            <option value="{{ i }}" selected>{{ i }}</option>
                          {% else %}
                            <option value="{{ i }}">{{ i }}</option>
                          {% endif %}
                        {% endfor %}
                      
                      {% endif %}
                  </select>

                  <!-- Remove -->
                  <a class="font-size-xs text-gray-400 ml-auto" href="#!" onclick="removeProductFromCartModal(this,'{{ product.product.id }}', '{{ cart_detail.cart.id }}')">
                    <i class="fe fe-x"></i> Remove
                  </a>

                </div>

              </div>
            </div>
          </li>

          {% endfor %}
        </ul>

        <!-- Footer -->
        <div class="modal-footer line-height-fixed font-size-sm bg-light mt-auto">
          <strong>Subtotal</strong> <strong class="ml-auto" id="modal__subtotal" data-subtotal="0">$0</strong>
        </div>

        <!-- Buttons -->
        <div class="modal-body">
          <a class="btn btn-block btn-dark" href="{% url 'process_to_checkout' %}">Continue to Checkout</a>
          <a class="btn btn-block btn-outline-dark" href="{% url 'cart' %}">View Cart</a>
        </div>

      </div>

      <!-- Empty cart (remove `.d-none` to enable it) -->
      <div class="modal-content d-none" id="empty__cart">

        <!-- Close -->
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <i class="fe fe-x" aria-hidden="true"></i>
        </button>

        <!-- Header-->
        <div class="modal-header line-height-fixed font-size-lg">
          <strong class="mx-auto">Your Cart (0)</strong>
        </div>

        <!-- Body -->
        <div class="modal-body flex-grow-0 my-auto">

          <!-- Heading -->
          <h6 class="mb-7 text-center">Your cart is empty ðŸ˜ž</h6>

          <!-- Button -->
          <a class="btn btn-block btn-outline-dark" href="#!">
            Continue Shopping
          </a>url

        </div>

      </div>

    </div>
  </div>

  <!-- NAVBAR -->
  <nav id="header" class="navbar navbar-expand-lg">
    <div class="container">

      <!-- Brand -->
      <a class="navbar-brand" href="{% url 'dashboard' %}" style="font-family: 'Gabriela', serif;">
        PUNAM FLUTES
      </a>

      <!-- Toggler -->
      <button class="navbar-toggler navbar-dark" type="button" data-toggle="collapse" data-target="#navbarCollapse"
        aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <!-- Collapse -->
      <div class="collapse navbar-collapse" id="navbarCollapse">

        <!-- Nav -->
        <ul class="navbar-nav mx-auto">
          <li class="nav-item ">

            <!-- Toggle -->
            <a class="nav-link" href="{% url 'dashboard' %}">Home</a>
          </li>
          <li class="nav-item dropdown {% block categories_name %} {% endblock %} ">

            <!-- Toggle -->
             <a class="nav-link" data-toggle="dropdown" href="#">Products</a>

            <!-- Menu -->
            <div class="dropdown-menu " style="min-width: 250px;">
              <div class="card card-lg">
                <div class="card-body">
                  <ul class="list-styled font-size-sm">
                  {% for cat in categories %}
                    <li class="list-styled-item">
                      <a class="list-styled-link" href="{% url 'category_product_list' slug=cat.slug %}">{{cat.display_name}}</a>
                    </li>
                  {% endfor %}
                  </ul>
                </div>
              </div>
            </div>
          </li>

          <li class="nav-item dropdown">

            <!-- Toggle -->
             <a class="nav-link" data-toggle="dropdown" href="#">Stores</a>

            <!-- Menu -->
            <div class="dropdown-menu " style="min-width: 250px;">
              <div class="card card-lg">
                <div class="card-body">
                  <ul class="list-styled font-size-sm">
                 
                    <li class="list-styled-item">
                      <a class="list-styled-link" href="{% url 'indianStore' %}">Indian Stores</a>
                    </li>
                    <li class="list-styled-item">
                      <a class="list-styled-link" href="{% url 'internationalStore' %}">International Stores</a>
                    </li>
                  </ul>
                </div>
              </div>
            </div>
          </li>

          <li class="nav-item dropdown">

            {% if all_support %}
            <!-- Toggle -->
             <a class="nav-link" data-toggle="dropdown" href="#">Support</a>

            <!-- Menu -->
            <div class="dropdown-menu " style="min-width: 250px;">
              <div class="card card-lg">
                <div class="card-body">
                  <ul class="list-styled font-size-sm">
                    {% for sp in all_support %}
                    <li class="list-styled-item">
                      <a class="list-styled-link" href="{% url 'support' slug=sp.slug %}">{{sp.display_name}}</a>
                    </li>
                    {% endfor %}
                  </ul>
                </div>
              </div>
            </div>

            {% endif %}
          </li>

          <li class="nav-item ">

            <!-- Toggle -->
            <a class="nav-link" href="{% url 'customer_query' %}">Contact</a>
          </li>

        </ul>

        <!-- Nav -->
        <ul class="navbar-nav flex-row">
          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'cart' %}">
              {% if request.user.is_authenticated and cart_length > 0 %}
                <span data-cart-items="{{ cart_length }}">
                  <i class="fe fe-shopping-cart"></i>
                </span>
              {% else %}
                <span>
                  <i class="fe fe-shopping-cart"></i>
                </span>
              {% endif %}
            </a>
          </li>
          
          {% if not request.user.is_authenticated %}
          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'customer_register' %}">
              <span>Register</span>
            </a>
          </li>
          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'customer_login' %}">
              <span>Login</span>
            </a>
          </li>
          
          {% else %}
          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'customer_profile' %}">
              <i class="fe fe-user"></i>
            </a>
          </li>
          
          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'orders' %}">
              <span>Order</span>
            </a>
          </li>

          <li class="nav-item ml-lg-n4">
            <a class="nav-link" href="{% url 'logout' %}">
              <span>Logout</span>
            </a>
          </li>
          {% endif %}
        </ul>

      </div>

    </div>
  </nav>


  <div id="wrapper">
    {% block content %}
    {% endblock %}
  </div>



  <!-- FOOTER -->
  <footer class="bg-dark bg-cover @@classList" style="background-image: url({% static 'homepage/img/footer_background.jpg'%})">
    <div class="py-12 border-bottom border-gray-700">
      <div class="container">
        <div class="row">
          <div class="col-12 col-md-3">

            <!-- Heading -->
            <h4 class="mb-6 text-white" style="font-family: 'Gabriela', serif;">PUNAM FLUTES</h4>

            <!-- Social -->
            <ul class="list-unstyled list-inline mb-7 mb-md-0">
              <li class="list-inline-item">
                <a href="#!" class="text-gray-350">
                  <i class="fab fa-facebook-f"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#!" class="text-gray-350">
                  <i class="fab fa-youtube"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#!" class="text-gray-350">
                  <i class="fab fa-twitter"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#!" class="text-gray-350">
                  <i class="fab fa-instagram"></i>
                </a>
              </li>
              <li class="list-inline-item">
                <a href="#!" class="text-gray-350">
                  <i class="fab fa-medium"></i>
                </a>
              </li>
            </ul>

          </div>
          <div class="col-6 col-sm">

            <!-- Heading -->
            <h6 class="heading-xxs mb-4 text-white">
              Stores
            </h6>

            <!-- Links -->
            <ul class="list-unstyled mb-7 mb-sm-0">
              <li>
                <a class="text-gray-300" href="{% url 'indianStore' %}">Indian Stores</a>
              </li>
              <li>
                <a class="text-gray-300" href="{% url 'internationalStore' %}">International Stores</a>
              </li>
            </ul>

          </div>
          <div class="col-6 col-sm">

            <!-- Heading -->
            <h6 class="heading-xxs mb-4 text-white">
              Shop
            </h6>

            <!-- Links -->
            <ul class="list-unstyled mb-7 mb-sm-0">
              {% for cat in categories %}
                {% if forloop.counter <= 4 %}
                  <li>
                    <a class="text-gray-300" href="{% url 'category_product_list' slug=cat.slug %}">{{cat.display_name}}</a>
                  </li>
                {% endif %}
              {% endfor %}
            </ul>

          </div>

          {% if all_support %}
            <div class="col-6 col-sm">
              <h6 class="heading-xxs mb-4 text-white">
                Support
              </h6>

              <ul class="list-unstyled mb-0">
                {% for sp in all_support %}
                <li>
                  <a class="text-gray-300" href="{% url 'support' slug=sp.slug %}">{{sp.display_name}}</a>
                </li>
                {% endfor %}
              </ul>
            </div>  
          {% endif %}
          <div class="col-6 col-sm">

            {% if contactUsContact %}
            <!-- Heading -->
            <h6 class="heading-xxs mb-4 text-white">
              Contact
            </h6>

            <div class="contact">
              {{ contactUsContact.description | safe }}
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
    <div class="py-6">
      <div class="container">
        <div class="row">
          <div class="col">

            <!-- Copyright -->
            <p class="mb-3 mb-md-0 font-size-xxs text-muted text-center">
              Â© 2021 All rights reserved. Punam Flutes.
            </p>

          </div>
          <div class="col-auto">

            <!-- Payment methods -->
            <!-- <img class="footer-payment" src="{% static 'assets/img/payment/mastercard.svg'%}" alt="...">
            <img class="footer-payment" src="{% static 'assets/img/payment/visa.svg' %}" alt="...">
            <img class="footer-payment" src="{% static 'assets/img/payment/amex.svg'%}" alt="...">
            <img class="footer-payment" src="{% static 'assets/img/payment/paypal.svg' %}" alt="...">
            <img class="footer-payment" src="{% static 'assets/img/payment/maestro.svg' %}" alt="...">
            <img class="footer-payment" src="{% static 'assets/img/payment/klarna.svg' %} " alt="..."> -->

          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- Footer -->
  <script src="{% static 'assets/libs/jquery/dist/jquery.min.js'%}"></script>
  <script src="{% static 'assets/libs/%40fancyapps/fancybox/dist/jquery.fancybox.min.js'%}"></script>
  <script src="{% static 'assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js'%}"></script>
  <script src="{% static 'assets/libs/flickity/dist/flickity.pkgd.min.js'%}"></script>
  <script src="{% static 'assets/libs/highlightjs/highlight.pack.min.js'%}"></script>
  <script src="{% static 'assets/libs/jarallax/dist/jarallax.min.js'%}"></script>
  <script src="{% static 'assets/libs/list.js/dist/list.min.js'%}"></script>
  <script src="{% static 'assets/libs/simplebar/dist/simplebar.min.js'%}"></script>
  <script src="{% static 'assets/libs/smooth-scroll/dist/smooth-scroll.min.js'%}"></script>
  <script src="{% static 'assets/libs/flickity-fade/flickity-fade.js'%}"></script>


  <!-- Theme JS -->
  <script src="{% static 'assets/js/theme.min.js'%}"></script>

  {% block script %}
  {% endblock %}

  <script>

    $(document).ready(()=>{
      $("[name=quantity__modal]").each(function(){
        updateProductPriceModal(this);
      })
    });

    /* Javascript for cart modal. */
    function removeProductFromCartModal(e,product_id, cart_id){
      $.ajax({
            url: "{% url 'remove_from_cart' %}",
            type: 'GET',
            dataType: 'json', 
            data: {
              'product_id': product_id,
              'cart_id': cart_id
            },
            success: function(res) {
                if(res.message=='success'){
                  $(e).closest('.list-group-item').remove();
                  updateSubTotalModal();
                }
                if(res.cart_length==0){
                  $('#modalShoppingCart').modal("hide");
                }
            }
      });
    }

    function updateSubTotalModal(){
      let currency = '{{ currency_symbol }}';

      let Subtotal = 0;
      let tex = 0;
      $("[id*=modal__product__price__]").each(function(){
          Subtotal = Subtotal + parseFloat($(this).attr('data-total'));
      });
      Subtotal = Subtotal.toFixed(2);
      $('#modal__subtotal').html(currency + Subtotal);
      $('#modal__subtotal').attr('data-subtotal', Subtotal);
    }

    function updateProductPriceModal(e){
      let currency = '{{ currency_symbol }}';
      let price = $(e).attr("data-price")
      let total_price = (price*e.value).toFixed(2);
      let total = e.value + ' * ' + currency + price +' = ' + currency + total_price;
      console.log(total, total_price, "ssss");
      $('#modal__product__price__'+e.id).html(total);
      $('#modal__product__price__'+e.id).attr("data-total",total_price);
      updateSubTotalModal();
    }

    $("[name=quantity__modal]").on('change', function() {
      console.log("clicked");
      updateProductPriceModal(this);
    });
  </script>

  <script>
    $('.contact > ul').addClass('list-unstyled')
    $('.contact > ul > li').addClass('text-gray-300')
  </script>

</body>

</html>